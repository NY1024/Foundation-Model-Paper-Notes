# Mitigating Hallucinations in Large Vision-Language Models with Instruction Contrastive Decoding

<figure><img src="../.gitbook/assets/image (226).png" alt=""><figcaption></figcaption></figure>

## 研究背景

大型视觉-语言模型（LVLMs）在从视觉输入生成上下文详细和连贯的响应方面越来越熟练。然而，它们在多模态决策制定和开放式生成中的应用受到幻觉现象的显著阻碍，即生成的文本不准确地代表视觉内容。幻觉现象在图像标题生成领域首次被探索，随着LVLMs对大型语言模型（LLMs）的复杂理解和生成能力的利用，幻觉的范围已经超越了单纯的物体存在，现在包括了生成内容中更复杂的元素，如属性和关系。因此，在评估LVLMs在忠实于事实视觉信息方面的性能时，区分生成内容中的幻觉部分和非幻觉部分变得至关重要。

## 过去方案和缺点

以往的研究已经开始揭示LVLM幻觉的主要原因，包括在训练过程中遇到的统计偏差和对语言先验的过度依赖。此外，多模态不对齐也被认为是幻觉发生的关键因素。为了解决数据集偏差，引入了注释丰富技术。为了对抗语言先验的影响，开发了后处理策略，并全面努力通过优化与人类的对齐来改善多模态对齐。尽管这些干预措施已被证明在减少幻觉方面有效，但它们需要大量的人类参与，并带来额外的训练或集成补充模块的重大计算成本。

<figure><img src="../.gitbook/assets/image (227).png" alt=""><figcaption></figcaption></figure>

## 本文方案和步骤

本文提出了一种名为指令对比解码（Instruction Contrastive Decoding，ICD）的方法，旨在减少LVLM推理过程中的幻觉。ICD的灵感来自于我们观察到所谓的干扰指令显著加剧了多模态融合模块中的幻觉。ICD通过对比标准指令和干扰指令下的分布，从而增加对齐不确定性，并有效地从原始分布中减去幻觉概念。通过在歧视性基准（POPE和MME）和生成基准（LLaVa-Bench）上的全面实验，我们证明了ICD显著缓解了物体级别和属性级别的幻觉。此外，我们的方法不仅解决了幻觉问题，还显著增强了LVLMs的一般感知和识别能力。

## 本文创新点与贡献

* 进行了深入分析，探讨了指令干扰如何加剧幻觉。通过统计偏差和语言先验，提供了对背后原因的细致理解。
* 基于上述见解，引入了ICD方法。这种新策略强调初始突出然后减弱幻觉，通过调整分布远离我们引发的幻觉，有效地减轻了推理过程中的幻觉。
* 通过广泛的实验和分析，验证了我们提出的ICD方法在歧视性和生成性幻觉基准上的有效性，展示了其在增强LVLMs性能方面的稳健性和多功能性。

## 本文实验

实验部分探讨了ICD方法在缓解幻觉方面的评估。我们的检验包括两个方面：首先，通过幻觉歧视的视角；其次，通过生成非幻觉内容的视角。具体而言，我们使用POPE基准评估ICD在缓解物体级别幻觉症状的有效性。此外，我们通过MME基准扩展了对包括物体级别和属性级别症状的全面分析。最后，使用LLaVa-Bench数据集评估我们方法在生成非幻觉内容方面的性能。

## 实验结论

实验结果表明，ICD方法在POPE基准的三个不同子集（MSCOCO、A-OKVQA和GQA设置）中始终优于基础LVLMs，特别是在所有指标上都显示出显著的改进。此外，ICD方法在MME幻觉子集中显著超越了基线LVLMs和VCD方法，证明了其在抑制物体和属性级别幻觉方面的卓越能力。在全面的MME基准测试中，ICD方法不仅在推理过程中有效管理幻觉，还提高了LVLMs的基础任务的准确性。

## 全文结论

我们介绍了一种新颖的指令对比解码方法，通过对比标准指令和干扰指令得到的分布来有效地分离幻觉概念。在各种基准测试和不同的LVLMs上的综合实验表明，我们的方法在减轻幻觉和显著提高LVLMs的一般感知和识别性能方面具有能力。



注：

指令对比解码（Instruction Contrastive Decoding，ICD）是一种旨在减少大型视觉-语言模型（LVLMs）在推理过程中产生幻觉现象的方法。幻觉是指模型生成的文本内容虽然流畅且连贯，但并不准确地反映实际的视觉内容。ICD方法的核心思想是通过对比标准指令和干扰指令下的分布，来增加模型输出与视觉输入对齐的不确定性，并有效地从原始分布中减去幻觉概念。

#### ICD方法的步骤：

1. **引入干扰指令**：
   * ICD方法首先引入了所谓的干扰指令（disturbance instructions），这是通过对标准指令添加特定的角色前缀来实现的。这些前缀旨在增加多模态对齐模块中的不确定性，从而放大幻觉现象。
2. **生成两个分布**：
   * 在LVLM的多模态对齐模块中，分别使用标准指令和干扰指令生成两个不同的分布。这两个分布反映了在不同指令下模型对视觉内容的理解和生成文本的可能性。
3. **对比解码**：
   * ICD方法的核心是对比解码过程，它不仅仅选择最大化概率的词（token），而是选择同时最大化标准指令下的概率和最小化干扰指令下的概率的词。这种方法通过引入一个超参数λ来调节对比惩罚的强度。
4. **自适应可能性约束**：
   * 为了避免错误地惩罚那些在视觉上下文中有根据的准确预测，ICD方法采用了自适应可能性约束。这种方法通过考虑LVLM的置信度水平，将决策过程缩小到一个更可靠的候选集合中，从而提高了模型输出的可靠性和有效性。

#### ICD方法的特点：

* **无需训练**：ICD方法是一种无需额外训练的方法，它与底层的LVLMs无关，可以直接应用于现有的模型。
* **对比解码**：通过对比标准指令和干扰指令下的分布，ICD方法能够突出幻觉概念，然后通过减去这些概念的概率来减少幻觉。
* **自适应性**：ICD方法通过自适应可能性约束来优化解码过程，确保模型输出更加准确和可靠。
* **增强感知和识别能力**：除了减少幻觉，ICD方法还能显著提高LVLMs在一般感知和识别任务上的性能。

#### ICD方法的贡献：

ICD方法为减少LVLMs中的幻觉提供了一种新的视角和解决方案。通过在多个基准测试上的实验验证，ICD方法不仅能够有效减轻物体级别和属性级别的幻觉，还能提升模型在多模态任务中的总体性能。这种方法为未来的研究和应用提供了一个强有力的工具，有助于推动LVLMs在多模态理解和生成任务中的发展。





## 阅读总结报告

本篇论文提出了一种新的减少大型视觉-语言模型中幻觉现象的方法——指令对比解码（ICD）。通过对比标准指令和干扰指令下的分布，ICD方法有效地减轻了LVLMs在推理过程中的幻觉现象，并提高了模型的感知和识别能力。实验结果表明，ICD在多个基准测试中均取得了显著的性能提升，证明了其在缓解幻觉方面的优势。此外，ICD方法的引入为未来研究提供了新的视角，有望进一步推动LVLMs在多模态理解和生成任务中的发展。
